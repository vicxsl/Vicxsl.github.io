(window.webpackJsonp=window.webpackJsonp||[]).push([[58],{603:function(s,e,n){"use strict";n.r(e);var a=n(16),t=Object(a.a)({},(function(){var s=this,e=s.$createElement,n=s._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"环境"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#环境"}},[s._v("#")]),s._v(" "),n("strong",[s._v("环境")])]),s._v(" "),n("p",[s._v("操作系统：win10")]),s._v(" "),n("p",[s._v("Python3")]),s._v(" "),n("p",[s._v("所需要的库：主要是PyQT5，因为加了一点拓展功能，所以还有sqlite3,Image,pyinstaller")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pip3 install pyqt5\npip3 install pyqt5-tools\npip3 install sqilte3\npip3 install Image\npip3 install pyinstaller\n\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("首先是pyqt5, 这个是我们的主要工具，用来做界面的，pyqt5-tools这个库主要是是在用QT Creator设计好界面之后，将ui文件转化为py文件；")]),s._v(" "),n("p",[s._v("sqlite3这个库可以安也可以不安，因为pyqt5里面有一个模块QtSql，它支持sqlite的操作；\nImage这个库主要是用来处理一下图片资源，以及最后程序的图标的\npyinstaller 最后将程序转化为可执行的exe文件")]),s._v(" "),n("h2",{attrs:{id:"pyinstaller"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#pyinstaller"}},[s._v("#")]),s._v(" pyinstaller")]),s._v(" "),n("p",[s._v("这里使用的打包工具是pyintaller，当然还有别的工具，这里就不再关注了。")]),s._v(" "),n("p",[s._v("pyinstaller安装好之后，通过pyinstall -h 可以看到一些帮助命令")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("$ pyinstaller -h\nusage: pyinstaller [-h] [-v] [-D] [-F] [--specpath DIR] [-n NAME]\n                   [--add-data <SRC;DEST or SRC:DEST>]\n                   [--add-binary <SRC;DEST or SRC:DEST>] [-p DIR]\n                   [--hidden-import MODULENAME]\n                   [--additional-hooks-dir HOOKSPATH]\n                   [--runtime-hook RUNTIME_HOOKS] [--exclude-module EXCLUDES]\n                   [--key KEY] [-d [{all,imports,bootloader,noarchive}]] [-s]\n                   [--noupx] [-c] [-w]\n                   [-i <FILE.ico or FILE.exe,ID or FILE.icns>]\n                   [--version-file FILE] [-m <FILE or XML>] [-r RESOURCE]\n                   [--uac-admin] [--uac-uiaccess] [--win-private-assemblies]\n                   [--win-no-prefer-redirects]\n                   [--osx-bundle-identifier BUNDLE_IDENTIFIER]\n                   [--runtime-tmpdir PATH] [--bootloader-ignore-signals]\n                   [--distpath DIR] [--workpath WORKPATH] [-y]\n                   [--upx-dir UPX_DIR] [-a] [--clean] [--log-level LEVEL]\n                   scriptname [scriptname ...]\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("具体的命令是什么作用可以在网上查一查")]),s._v(" "),n("p",[s._v("这里说一下要用到的几个命令：")]),s._v(" "),n("p",[s._v("-i icon.ico    为程序设置图标 （注意图标大小格式有要求，一般128*128基本能满足要求）\n"),n("strong",[s._v("-F：表示是单文件exe")]),s._v(" "),n("strong",[s._v("-w,–windowed,–noconsole     使用Windows子系统执行.当程序启动的时候不会打开命令行(只对Windows有效)")]),s._v("\n-c,–nowindowed,–console     使用控制台子系统执行(默认)(只对Windows有效)\n-p  文件名              依赖的文件名字，即导入的本地文件或者资源文件\n--hidden-import      导入的文件名")]),s._v(" "),n("p",[s._v("我的理解是-p 与--hidden-import一般一起使用，比如要导入images.py这个本地资源包，得如下使用：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pyinstaller -i logo.ico -w -F PasswordManagerSyster.py -p images.py --hidden-import images\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("当然也可以直接使用另外一个命令pyi-makespec 程序文件  ，生成spec文件（执行完上面一条命令也会生成一个spec文件）")]),s._v(" "),n("p",[s._v("spec文件如下：")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("# -*- mode: python -*-\nblock_cipher = None\na = Analysis(['PasswordManageSystem.py'],\n             pathex=['images.py', 'C:\\\\code\\\\Python\\\\PyQT5test\\\\PasswordManagerSystem'],\n             binaries=[],\n             datas=[],\n             hiddenimports=['images'],\n             hookspath=[],\n             runtime_hooks=[],\n             excludes=[],\n             win_no_prefer_redirects=False,\n             win_private_assemblies=False,\n             cipher=block_cipher,\n             noarchive=False)\npyz = PYZ(a.pure, a.zipped_data,\n             cipher=block_cipher)\nexe = EXE(pyz,\n          a.scripts,\n          a.binaries,\n          a.zipfiles,\n          a.datas,\n          [],\n          name='PWManager',\n          debug=False,\n          bootloader_ignore_signals=False,\n          strip=False,\n          upx=True,\n          runtime_tmpdir=None,\n          console=False , icon='logo.ico')\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br")])]),n("p",[s._v("其实通过对比，就可以发现，在shell或者说cmd命令行下输入得命令，最后都能在这个spec文件中找到对应得地方，所以也可以直接修改spec文件。")]),s._v(" "),n("p",[s._v("Analysis中得第一个参数就是我们得main文件")]),s._v(" "),n("p",[s._v("pathex里面的内容，就是-p后面跟的文件")]),s._v(" "),n("p",[s._v("hiddenimports   要导入的本地包")]),s._v(" "),n("p",[s._v("console=False        #这个就是 -w或者-c")]),s._v(" "),n("p",[s._v("icon='logo.ico'  就是最后生成的程序图标")]),s._v(" "),n("p",[s._v("修改好这个spec文件，最后执行")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pyinstaller PasswordManageSystem.spec\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"实践"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实践"}},[s._v("#")]),s._v(" 实践")]),s._v(" "),n("p",[s._v("除了命令行，也可以直接使用pycharm的External Tools 安装 pyinstaller工具")]),s._v(" "),n("p",[s._v("使用打包命令")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("pyinstaller -F -w C:\\Users\\JulianYang\\Desktop\\testJ\\milestone\\camera1.py\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("选择配置参数")]),s._v(" "),n("p",[n("code",[s._v("program： E:\\PycharmProjects\\untitled\\venv\\Scripts\\pyinstaller.exe")])]),s._v(" "),n("p",[n("code",[s._v("Arguments： -F -w $FileNameWithoutExtension$.py")])]),s._v(" "),n("p",[n("code",[s._v("working directory：$FileDir$")])]),s._v(" "),n("p",[s._v("打开dist目录下生成的main.exe 错误提示："),n("code",[s._v("failed to cecute script main")])]),s._v(" "),n("p",[s._v("PyQt5 Pyinstaller Failed to execute script部分解决方法")]),s._v(" "),n("ol",[n("li",[s._v("取消 "),n("strong",[s._v("-w")]),s._v(" 参数，让他显示命令窗口；")]),s._v(" "),n("li",[s._v("按住shift，右击鼠标，选择 “"),n("strong",[s._v("在此处打开powershell")]),s._v("”（或"),n("strong",[s._v("命令窗口")]),s._v("）；")]),s._v(" "),n("li",[s._v("将生成的"),n("strong",[s._v("exe")]),s._v("拖入，按回车；")]),s._v(" "),n("li",[s._v("可以看到具体的"),n("strong",[s._v("报错信息")]),s._v("；")]),s._v(" "),n("li",[s._v("如果是“"),n("strong",[s._v("unable to find Qt5xx.dll")]),s._v("”，就将Python安装路径下的**/Lib/site-packages/PyQt5/Qt/bin**添加到环境变量；")]),s._v(" "),n("li",[s._v("如果是“"),n("strong",[s._v("no module xxx")]),s._v("”，就"),n("strong",[s._v("pip install")]),s._v("安装对应的模块；")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("PS E:\\PycharmProjects\\Calculation_Tree_Tool\\treeTool\\dist> E:\\PycharmProjects\\Calculation_Tree_Tool\\treeTool\\dist\\main.exe\nTraceback (most recent call last):\n  File \"main.py\", line 19, in <module>\nModuleNotFoundError: No module named 'treeTool'\n[3516] Failed to execute script main\nPS E:\\PycharmProjects\\Calculation_Tree_Tool\\treeTool\\dist>\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("查看导入的包路径：from treeTool.mwin import Ui_MWin")]),s._v(" "),n("p",[s._v("发现是导入路径中多了一层包路径，导致运行时从对应的路径无法导入模块。")]),s._v(" "),n("p",[s._v("项目路径：E:\\PycharmProjects\\Calculation_Tree_Tool\\treeTool")]),s._v(" "),n("p",[n("strong",[s._v("去除子目录treeTool,将所有源文件移到根目录，重新打包exe，运行成功！")])]),s._v(" "),n("h2",{attrs:{id:"小结"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),n("p",[s._v("至此，这个小小的项目就算完结了。")]),s._v(" "),n("p",[s._v("至于说给这个软件添加版本信息，帮助信息，或者要给它增加其他功能什么的，这个等学的比较深入的时候再说吧，")]),s._v(" "),n("p",[s._v("毕竟这只是一个练习项目而已，这么简单的功能")])])}),[],!1,null,null,null);e.default=t.exports}}]);