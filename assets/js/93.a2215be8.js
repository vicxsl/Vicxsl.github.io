(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{639:function(t,v,_){"use strict";_.r(v);var a=_(16),r=Object(a.a)({},(function(){var t=this,v=t.$createElement,_=t._self._c||v;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"字节终面-两个文件的公共url怎么找"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#字节终面-两个文件的公共url怎么找"}},[t._v("#")]),t._v(" 字节终面：两个文件的公共url怎么找？")]),t._v(" "),_("h2",{attrs:{id:"题目"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#题目"}},[t._v("#")]),t._v(" 题目")]),t._v(" "),_("p",[t._v("今天，我们来看一道非常经典的面试题目。")]),t._v(" "),_("p",[t._v("在字节跳动的终面中，居然遇到这个题目，好亲切。题目如下：")]),t._v(" "),_("p",[t._v("A文件有32亿个url链接，B文件有64亿个url链接，求A和B中的公共url链接。")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166016455/image-20210909134015764.png",alt:"image-20210909134015764"}})]),t._v(" "),_("h2",{attrs:{id:"一、初步思考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#一、初步思考"}},[t._v("#")]),t._v(" 一、初步思考")]),t._v(" "),_("p",[t._v("一些朋友可能觉得，这个问题很简单啊，把A文件和B文件同时加载到内存中，然后进行循环查找比较，貌似万事大吉。")]),t._v(" "),_("p",[t._v("为了便于理解原问题，我用图解的方式来进行。设A文件有5个美女，居于上面一行；B文件有5个美女，居于下面一行。")]),t._v(" "),_("p",[t._v("那么，怎么找出上下两行的公共部分呢？且看最直观的思路，那就一个个地找呗。")]),t._v(" "),_("p",[t._v("第1步：")]),t._v(" "),_("p",[t._v("以紫衫龙王为例，发现下面一行没有紫衫龙王，所以紫衫龙王不是上下的公共部分，如图：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166090326/image-20210909134129895.png",alt:"image-20210909134129895"}}),t._v(" "),_("p",[t._v("第2步：")]),t._v(" "),_("p",[t._v("以黄蓉为例，发现下面一行有黄蓉，所以黄蓉是上下的公共部分，如图：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166137609/image-20210909134217172.png",alt:"image-20210909134217172"}}),t._v(" "),_("p",[t._v("第3步：")]),t._v(" "),_("p",[t._v("以穆念慈为例，发现下面一行没有穆念慈，所以穆念慈不是上下的公共部分，如图：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166166970/image-20210909134246531.png",alt:"image-20210909134246531"}}),t._v(" "),_("p",[t._v("第4步：")]),t._v(" "),_("p",[t._v("以白发魔女为例，发现下面一行有白发魔女，所以白发魔女是上下的公共部分，如图：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166192967/image-20210909134312545.png",alt:"image-20210909134312545"}}),t._v(" "),_("p",[t._v("第5步：")]),t._v(" "),_("p",[t._v("以赵敏为例，发现下面一行有赵敏，所以赵敏是上下的公共部分，如图：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631166214185/image-20210909134333763.png",alt:"image-20210909134333763"}}),t._v(" "),_("p",[t._v("我们看到，整个过程进行了25次比较。显然，上下两行的公共部分是：黄蓉、赵敏、白发魔女。")]),t._v(" "),_("p",[t._v("如果A有m个元素，B有n个元素，则时间复杂度为O(m*n)，显然，无法通过字节跳动的面试。")]),t._v(" "),_("h2",{attrs:{id:"二、进阶思考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#二、进阶思考"}},[t._v("#")]),t._v(" 二、进阶思考")]),t._v(" "),_("p",[t._v("从时间复杂度上来讲，上面的方法肯定不是最优的，这里的问题在哪里呢？问题还是出在查找的思路上。")]),t._v(" "),_("p",[t._v("我们以紫衫龙王的查找为例，使用遍历查找的思路是很糟糕的。从下图可以看出，需要查找5次才有结果：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176679640/image-20210909163759200.png",alt:"image-20210909163759200"}}),t._v(" "),_("p",[t._v("回顾一下查找算法，比遍历查找更快的是二分查找，比二分查找更快的是哈希查找。")]),t._v(" "),_("p",[t._v("来看看使用哈希表（使用HashMap存放？）进行查找的图示，哈希查找的时间复杂度为O(1)，不需要比较5次：")]),t._v(" "),_("p",[_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176712464/image-20210909163832032.png",alt:"image-20210909163832032"}}),_("img",{attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176789508/image-20210909163949088.png",alt:"image-20210909163949088"}})]),t._v(" "),_("p",[t._v("貌似万事大吉了，但依然无法通过字节跳动的面试，这又是为什么呢？猫腻在哪里？")]),t._v(" "),_("p",[t._v("醒醒，快醒醒，这明显是一道海量数据问题，内存容纳不下，所以必须想其他的方法。")]),t._v(" "),_("h2",{attrs:{id:"三、终极思考"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#三、终极思考"}},[t._v("#")]),t._v(" 三、终极思考")]),t._v(" "),_("p",[t._v("由于是海量数据问题，内存容纳不下，那怎么办呢？可以"),_("strong",[t._v("考虑使用分治的思想")]),t._v("，说白了，就是大问题化小，小问题化了。")]),t._v(" "),_("p",[t._v("还是以上述的美女为例，我们可以考虑对这些美女进行分类。具体的分类标准有很多，比如，可以考虑以名字长度来分。")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176789508/image-20210909163949088.png",alt:"image-20210909163949088"}})]),t._v(" "),_("p",[t._v("根据名字长度划分后图示如下：")]),t._v(" "),_("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176821667/image-20210909164021248.png",alt:"image-20210909164021248"}}),t._v(" "),_("p",[t._v("显而易见，这就实现了化大为小，在化大为小之后，内存足够容纳得下，不用担心了。")]),t._v(" "),_("p",[t._v("很容易发现，上下两行的公共部分分别是：黄蓉、赵敏、白发魔女。问题得到解决啦。")]),t._v(" "),_("p",[t._v("值得注意的是，我们以名字长度为4的房间为例，针对紫衫龙王，仍选择用哈希查找。")]),t._v(" "),_("h2",{attrs:{id:"四、破解原题"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#四、破解原题"}},[t._v("#")]),t._v(" 四、破解原题")]),t._v(" "),_("p",[t._v("我们一起来回顾下原题：")]),t._v(" "),_("p",[t._v("A文件有32亿个url链接，B文件有64亿个url链接，求A和B中的公共url链接。")]),t._v(" "),_("p",[t._v("显然，内存容纳不下这么多数据，因此需要采用分割的方法对A和B两个文件中的url进行分类。")]),t._v(" "),_("p",[t._v("怎么分类呢？我们当然可以根据url的长度进行分类，分成不同的比较组，比如：")]),t._v(" "),_("p",[_("img",{attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176886628/image-20210909164126240.png",alt:"image-20210909164126240"}})]),t._v(" "),_("p",[t._v("这样就能解决问题了。但是，还有一个问题，这种划分合理吗？是否存在某个长度的url有很多呢？")]),t._v(" "),_("p",[t._v("会的，一定会的。如果"),_("strong",[t._v("某个长度的url很多")]),t._v("（数据倾斜），会导致小文件也很大，导致内存容纳不下，那怎么办？")]),t._v(" "),_("p",[t._v("可以考虑采取哈希的思想，具体来说就是对每个url求md5值，然后按照md5值的首字母来分割：")]),t._v(" "),_("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://gitee.com/vicxsl/img/raw/master/img/1631176933785/image-20210909164213400.png",alt:"image-20210909164213400"}}),t._v(" "),_("p",[t._v("把大文件按照一定的规则切割成小文件后，内存容纳不下的问题解决了。按照上述分法之后，如果文件还是太大，那怎么办呢？")]),t._v(" "),_("p",[t._v("很简单，可以考虑多分割一些，比如按照md5后的前两个字母来分割。显然，一个大文件可以分为256个小文件，如下所示：")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("文件分割")])]),t._v(" "),_("th",[t._v("**md5后前两个字母 **")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("小文件1")]),t._v(" "),_("td",[t._v("aa")])]),t._v(" "),_("tr",[_("td",[t._v("小文件2")]),t._v(" "),_("td",[t._v("ab")])]),t._v(" "),_("tr",[_("td",[t._v("小文件3")]),t._v(" "),_("td",[t._v("ac")])]),t._v(" "),_("tr",[_("td",[t._v("小文件4")]),t._v(" "),_("td",[t._v("ad")])]),t._v(" "),_("tr",[_("td",[t._v("...")]),t._v(" "),_("td",[t._v("...")])]),t._v(" "),_("tr",[_("td",[t._v("小文件256")]),t._v(" "),_("td",[t._v("zz")])])])]),t._v(" "),_("p",[_("strong",[t._v("总之，核心思想是：")])]),t._v(" "),_("ul",[_("li",[t._v("哈希分治，把大文件切割为很多的小文件")]),t._v(" "),_("li",[t._v("在每一组小文件中，找出它们的共同url")])]),t._v(" "),_("p",[t._v("表格示意图如下：")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[_("strong",[t._v("md5后前两个字母")])]),t._v(" "),_("th",[t._v("**A **")]),t._v(" "),_("th",[t._v("VS")]),t._v(" "),_("th",[t._v("**B **")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("aa")]),t._v(" "),_("td",[t._v("A1文件")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("B1文件")])]),t._v(" "),_("tr",[_("td",[t._v("ab")]),t._v(" "),_("td",[t._v("A2文件")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("B2文件")])]),t._v(" "),_("tr",[_("td",[t._v("ac")]),t._v(" "),_("td",[t._v("A3文件")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("B3文件")])]),t._v(" "),_("tr",[_("td",[t._v("ad")]),t._v(" "),_("td",[t._v("A4文件")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("B4文件")])]),t._v(" "),_("tr",[_("td",[t._v("...")]),t._v(" "),_("td",[t._v("...")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("...")])]),t._v(" "),_("tr",[_("td",[t._v("zz")]),t._v(" "),_("td",[t._v("A256文件")]),t._v(" "),_("td",[t._v("VS")]),t._v(" "),_("td",[t._v("B256文件")])])])]),t._v(" "),_("p",[t._v("哈希分治，化大为小，是一种重要的思想。我们也会一步一个脚印，争取每篇文章讲清讲透一件事，也希望大家阅读后有所收获，心情愉快。")])])}),[],!1,null,null,null);v.default=r.exports}}]);